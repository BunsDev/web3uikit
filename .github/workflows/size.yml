name: size
on: [pull_request]
jobs:
    size:
        runs-on: ubuntu-latest
        env:
            CI_JOB_NUMBER: 1
        steps:
            - name: Checkout
              uses: actions/checkout@v2

            - name: Install pnpm
              uses: pnpm/action-setup@v2.2.2
              with:
                  version: 7

            - uses: andresz1/size-limit-action@v1
              with:
                  github_token: ${{ secrets.GITHUB_TOKEN }}

            - run: npm config set '//registry.npmjs.org/:_authToken' "${{ secrets.NPM_TOKEN }}" --scope=@web3uikit

            - name: publish to NPM as latest version
              if: '!github.event.release.prerelease'
              run: npm publish --tag latest
              env:
                  # Use a token to publish to NPM. See below for how to set it up
                  NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
